<div id="content">


  <div class="content-part content-title">
    <div class="content-subpart content-subpart-title">
      <div class="content-subpart-title-text">
        Лабораторные работы <p class="text-count" >[{{labWorks? labWorks.length : '0'}}]</p>
      </div>
      <div class="content-subpart-title-buttons">
        <!--  Dialogs for extra actions-->
        <p-dialog header="Удалить случайный объект заданной сложности" [dismissableMask]="true" [(visible)]="displayModal1" [modal]="true"
                  [style]="{width: '40vw', top: '-180px'}" [draggable]="false" [resizable]="false">
          <p class="dialog-text">
            Выберите сложность, и нажмите кнопку, чтобы удалить случайный объект заданной сложности
          </p>
          <p-dropdown [options]="optionDifficulties" [(ngModel)]="selectedDifficultyExtra" placeholder="Выберите сложность" optionLabel="name"></p-dropdown>
          <ng-template pTemplate="footer">
            <p-button icon="pi pi-trash" (onClick)="deleteRandom(); refresh()" label="Удалить" styleClass="p-button-text"></p-button>
          </ng-template>
        </p-dialog>

        <p-dialog header="Вернуть количество объектов при заданной сложности" [dismissableMask]="true" [(visible)]="displayModal2" [modal]="true"
                  [style]="{width: '40vw', top: '-180px'}" [draggable]="false" [resizable]="false">
          <p class="dialog-text">
            Выберите сложность, и нажмите кнопку, чтобы посмотреть количество объектов, сложность которых выше заданной
          </p>
          <p-dropdown [options]="optionDifficulties" [(ngModel)]="selectedDifficultyExtra" placeholder="Выберите сложность" optionLabel="name"></p-dropdown>
          <ng-template pTemplate="footer">
            <p-button icon="pi pi-check" (onClick)="getCount(); displayModal2=false" label="Отправить" styleClass="p-button-text"></p-button>
          </ng-template>
        </p-dialog>

        <p-splitButton (onClick)="showModalDialog1()" label="Удалить объект по сложности" [model]="splitButtonItems" class="button-split"></p-splitButton>

        <!--Create dialog-->
        <p-dialog header="Добавить лабораторную работу" [dismissableMask]="true" [(visible)]="displayModalCreate" [modal]="true"
                  [style]="{width: '40vw'}" [draggable]="false" [resizable]="false">
          <p class="dialog-text">
            Заполните поля и нажмите кнопку добавить
          </p>
          <form [formGroup]="formCreate" novalidate (ngSubmit)="createLabWork()">
            <div class="dialog-input-div">
              <p class="dialog-text dialog-text-input">
                Имя
              </p>
              <input type="text" pInputText formControlName="labName"/>
            </div>
            <div class="dialog-input-div">
              <p class="dialog-text dialog-text-input">
                Координаты
              </p>
              <div>
                <p-inputNumber style="margin-right: 10px;" formControlName="labX" mode="decimal"></p-inputNumber>
                <p-inputNumber formControlName="labY" mode="decimal"></p-inputNumber>
              </div>
            </div>
            <div class="dialog-input-div">
              <p class="dialog-text dialog-text-input">
                Минимальная оценка
              </p>
              <p-inputNumber formControlName="labMinimalPoint" mode="decimal"></p-inputNumber>
            </div>
            <div class="dialog-input-div">
              <p class="dialog-text dialog-text-input">
                Сложность
              </p>
              <p-dropdown [options]="optionDifficulties" formControlName="labDifficulty" placeholder="Выберите сложность" optionLabel="name" optionValue="value"></p-dropdown>
            </div>
            <div style="margin-bottom: 50px !important;" class="dialog-input-div">
              <p class="dialog-text dialog-text-input">
                Дисциплина
              </p>
              <p-dropdown [options]="optionDisciplines" formControlName="labDiscipline" placeholder="Выберите дисциплину" optionLabel="name">

              </p-dropdown>
            </div>

            <p-button icon="pi pi-plus" [disabled]="formCreate.invalid" (onClick)="displayModalCreate=false" label="Добавить" type="submit" styleClass="p-button-text"></p-button>
          </form>
        </p-dialog>

        <button (click)="showModalDialogCreate()" pButton pRipple type="button" icon="pi pi-plus" class=" p-button-text button-add"></button>
      </div>
    </div>
  </div>

  <div class="content-part content-filter">
    <div class="content-subpart content-filter-buttons">

<!--      Filter name-->
      <p-overlayPanel #opName (onHide)="filterList()">
        <div class="op-content">
          <input type="text" pInputText [(ngModel)]="name"/>
          <small id="username-help">Введите шаблон имени</small>
        </div>
      </p-overlayPanel>
      <button [ngClass]="{'overlay-button-filtered' : (name != '' && name != null)}" pButton class="overlay-button" label="Имя " icon="pi pi-chevron-down" iconPos="right" (click)="opName.toggle($event)"></button>

<!--      Filter coordinates-->
      <p-overlayPanel #opCoordinates (onHide)="filterList()">
        <div class="op-content">
          <p class="overlay-header">Координата X</p>
          <div class="op-content op-content-row op-content-row-coordinates">
            <p>От</p>
            <p-inputNumber [(ngModel)]="coordinatesXFrom" mode="decimal"></p-inputNumber>
            <p>До</p>
            <p-inputNumber [(ngModel)]="coordinatesXUntil" mode="decimal" [min]="coordinatesXFrom"></p-inputNumber>
          </div>

          <p class="overlay-header">Координата Y</p>
          <div class="op-content op-content-row op-content-row-coordinates">
            <p>От</p>
            <p-inputNumber [(ngModel)]="coordinatesYFrom" mode="decimal" [min]="-895"></p-inputNumber>
            <p>До</p>
            <p-inputNumber [(ngModel)]="coordinatesYUntil" mode="decimal" [min]="coordinatesYFrom"></p-inputNumber>
          </div>
        </div>
      </p-overlayPanel>
      <button [ngClass]="{'overlay-button-filtered' : isCoordinatesFiltered()}" pButton class="overlay-button" label="Координаты" icon="pi pi-chevron-down" iconPos="right" (click)="opCoordinates.toggle($event)"></button>

<!--      Filter creation date-->
      <p-overlayPanel #opCreationDate (onHide)="filterList()">
        <div class="op-content">
          <div class="op-content op-content-row op-content-row-creation-date">
            <p-calendar [(ngModel)]="rangeDates" [showIcon]="true" selectionMode="range" dateFormat="dd-mm-yy">
            </p-calendar>
          </div>
        </div>
      </p-overlayPanel>
      <button [ngClass]="{'overlay-button-filtered' : rangeDates != null}" pButton class="overlay-button" label="Дата создания" icon="pi pi-chevron-down" iconPos="right" (click)="opCreationDate.toggle($event)"></button>

<!--      Filer minimal point-->
      <p-overlayPanel #opMinimalPoint (onHide)="filterList()">
        <div class="op-content op-content-row op-content-row-coordinates">
          <p>От</p>
          <p-inputNumber [(ngModel)]="minimalPointFrom" mode="decimal" [min]="1"></p-inputNumber>
          <p>До</p>
          <p-inputNumber [(ngModel)]="minimalPointUntil" mode="decimal" [min]="minimalPointFrom"></p-inputNumber>
        </div>
      </p-overlayPanel>
      <button [ngClass]="{'overlay-button-filtered' : isMinimalPointFiltered()}" pButton class="overlay-button" label="Минимальная оценка" icon="pi pi-chevron-down" iconPos="right" (click)="opMinimalPoint.toggle($event)"></button>

<!--      Filter difficulty-->
      <p-overlayPanel #opDifficulty (onHide)="filterList()">
        <div class="op-content">
          <p-checkbox name="groupname" label="Легко" value="VERY_EASY" [(ngModel)]="selectedDifficulties"></p-checkbox>
          <p-checkbox name="groupname" label="Нормально" value="NORMAL" [(ngModel)]="selectedDifficulties"></p-checkbox>
          <p-checkbox name="groupname" label="Невозможно" value="IMPOSSIBLE" [(ngModel)]="selectedDifficulties"></p-checkbox>
        </div>
      </p-overlayPanel>
      <button [ngClass]="{'overlay-button-filtered' : selectedDifficulties != null}" pButton class="overlay-button" label="Сложность" icon="pi pi-chevron-down" iconPos="right" (click)="opDifficulty.toggle($event)"></button>

<!--      Filter discipline-->
      <p-overlayPanel #opDiscipline (onHide)="filterList()">
        <div class="op-content op-content-discipline">
          <p class="overlay-header">Название</p>
          <p-multiSelect [options]="optionDisciplines" [(ngModel)]="selectedDisciplines" optionLabel="name" optionValue="id"></p-multiSelect>

<!--          <p class="overlay-header">Кол-во часов</p>-->
<!--          <p-inputNumber [(ngModel)]="lectureHours" mode="decimal" [min]="0"></p-inputNumber>-->
        </div>
      </p-overlayPanel>
      <button [ngClass]="{'overlay-button-filtered' : isDisciplineFiltered()}" pButton class="overlay-button" label="Дисциплина" icon="pi pi-chevron-down" iconPos="right" (click)="opDiscipline.toggle($event)"></button>

    </div>
  </div>

  <div class="content-part content-collection">
    <div class="content-subpart content-collection-list">
      <div class="labwork-content" *ngFor="let lab of labWorks">
        <div class="labwork-content-id">
          <p>
            {{ lab.id }}
          </p>
        </div>
        <div class="labwork-content-data">
          <div class="lw-data-item1">
            <p>
              {{ lab.discipline.name }} - {{ lab.name }}
            </p>
          </div>
          <div class="lw-data-item2">
            <p>
              Минимальная оценка -- {{ lab.minimalPoint }}
            </p>
            <div [ngSwitch]="lab.difficulty">
              <ng-template ngSwitchCase="VERY_EASY"><p>Легко</p></ng-template>
              <ng-template ngSwitchCase="NORMAL"><p>Нормально</p></ng-template>
              <ng-template ngSwitchCase="IMPOSSIBLE"><p>Невозможно</p></ng-template>
              <ng-template ngSwitchDefault><p></p></ng-template>
            </div>
          </div>
          <div class="lw-data-item3">
            <div class="lw-data-item3-coordinates">
              <p class="lw-data-item3-coordinates-title">X</p>
              <p class="lw-data-item3-coordinates-value">{{ lab.coordinates.x }}</p>
            </div>
            <div class="lw-data-item3-coordinates">
              <p class="lw-data-item3-coordinates-title">Y</p>
              <p class="lw-data-item3-coordinates-value">{{ lab.coordinates.y }}</p>
            </div>
          </div>

          <div class="lw-data-item4">
            <p>
              {{lab.creationDate}}
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<p-toast position="top-right" [baseZIndex]="20000">
</p-toast>
